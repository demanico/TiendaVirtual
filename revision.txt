Nicolas, hay muchas cosas en este código que me llaman mucho la atención... Cuando viaje hablaremos un poco de tu código.